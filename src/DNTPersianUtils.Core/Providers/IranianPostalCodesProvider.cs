using System;
using System.Collections.Generic;
using System.Linq;

namespace DNTPersianUtils.Core;

/// <summary>
///     تامين كننده اطلاعات محلي كدهاي پستي ايران
/// </summary>
public static class IranianPostalCodesProvider
{
    /// <summary>
    ///     تامين كننده اطلاعات محلي كدهاي پستي ايران
    /// </summary>
    public static IList<PostalCode> Items => new List<PostalCode>
    {
        new()
        {
            Id = "11",
            ProvinceName = "تهران"
        },
        new()
        {
            Id = "13",
            ProvinceName = "تهران"
        },
        new()
        {
            Id = "14",
            ProvinceName = "تهران"
        },
        new()
        {
            Id = "15",
            ProvinceName = "تهران"
        },
        new()
        {
            Id = "16",
            ProvinceName = "تهران"
        },
        new()
        {
            Id = "17",
            ProvinceName = "تهران"
        },
        new()
        {
            Id = "18",
            ProvinceName = "تهران"
        },
        new()
        {
            Id = "19",
            ProvinceName = "تهران"
        },
        new()
        {
            Id = "21",
            ProvinceName = "تهران"
        },
        new()
        {
            Id = "34",
            ProvinceName = "قزوین"
        },
        new()
        {
            Id = "35",
            ProvinceName = "سمنان"
        },
        new()
        {
            Id = "36",
            ProvinceName = "سمنان"
        },
        new()
        {
            Id = "37",
            ProvinceName = "قم"
        },
        new()
        {
            Id = "38",
            ProvinceName = "مرکزی"
        },
        new()
        {
            Id = "39",
            ProvinceName = "مرکزی"
        },
        new()
        {
            Id = "41",
            ProvinceName = "گیلان"
        },
        new()
        {
            Id = "42",
            ProvinceName = "گیلان"
        },
        new()
        {
            Id = "43",
            ProvinceName = "گیلان"
        },
        new()
        {
            Id = "44",
            ProvinceName = "گیلان"
        },
        new()
        {
            Id = "45",
            ProvinceName = "زنجان"
        },
        new()
        {
            Id = "46",
            ProvinceName = "مازندران"
        },
        new()
        {
            Id = "47",
            ProvinceName = "مازندران"
        },
        new()
        {
            Id = "48",
            ProvinceName = "گلستان"
        },
        new()
        {
            Id = "49",
            ProvinceName = "گلستان"
        },
        new()
        {
            Id = "51",
            ProvinceName = "آذربایجان شرقی"
        },
        new()
        {
            Id = "52",
            ProvinceName = "آذربایجان شرقی"
        },
        new()
        {
            Id = "53",
            ProvinceName = "آذربایجان شرقی"
        },
        new()
        {
            Id = "54",
            ProvinceName = "آذربایجان شرقی"
        },
        new()
        {
            Id = "55",
            ProvinceName = "آذربایجان شرقی"
        },
        new()
        {
            Id = "56",
            ProvinceName = "اردبیل"
        },
        new()
        {
            Id = "57",
            ProvinceName = "آذربایجان غربی"
        },
        new()
        {
            Id = "58",
            ProvinceName = "آذربایجان غربی"
        },
        new()
        {
            Id = "59",
            ProvinceName = "آذربایجان غربی"
        },
        new()
        {
            Id = "61",
            ProvinceName = "همدان"
        },
        new()
        {
            Id = "62",
            ProvinceName = "همدان"
        },
        new()
        {
            Id = "63",
            ProvinceName = "خوزستان"
        },
        new()
        {
            Id = "64",
            ProvinceName = "خوزستان"
        },
        new()
        {
            Id = "65",
            ProvinceName = "خوزستان"
        },
        new()
        {
            Id = "66",
            ProvinceName = "کردستان"
        },
        new()
        {
            Id = "67",
            ProvinceName = "کرمانشاه"
        },
        new()
        {
            Id = "68",
            ProvinceName = "لرستان"
        },
        new()
        {
            Id = "69",
            ProvinceName = "ایلام"
        },
        new()
        {
            Id = "71",
            ProvinceName = "فارس"
        },
        new()
        {
            Id = "72",
            ProvinceName = "فارس"
        },
        new()
        {
            Id = "73",
            ProvinceName = "فارس"
        },
        new()
        {
            Id = "74",
            ProvinceName = "فارس"
        },
        new()
        {
            Id = "75",
            ProvinceName = "بوشهر"
        },
        new()
        {
            Id = "76",
            ProvinceName = "کرمان"
        },
        new()
        {
            Id = "77",
            ProvinceName = "کرمان"
        },
        new()
        {
            Id = "78",
            ProvinceName = "کرمان"
        },
        new()
        {
            Id = "79",
            ProvinceName = "هرمزگان"
        },
        new()
        {
            Id = "81",
            ProvinceName = "اصفهان"
        },
        new()
        {
            Id = "83",
            ProvinceName = "اصفهان"
        },
        new()
        {
            Id = "84",
            ProvinceName = "اصفهان"
        },
        new()
        {
            Id = "85",
            ProvinceName = "یزد"
        },
        new()
        {
            Id = "86",
            ProvinceName = "یزد"
        },
        new()
        {
            Id = "87",
            ProvinceName = "یزد"
        },
        new()
        {
            Id = "88",
            ProvinceName = "یزد"
        },
        new()
        {
            Id = "89",
            ProvinceName = "یزد"
        },
        new()
        {
            Id = "91",
            ProvinceName = "خراسان رضوی"
        },
        new()
        {
            Id = "92",
            ProvinceName = "خراسان رضوی"
        },
        new()
        {
            Id = "93",
            ProvinceName = "خراسان رضوی"
        },
        new()
        {
            Id = "95",
            ProvinceName = "خراسان رضوی"
        },
        new()
        {
            Id = "96",
            ProvinceName = "خراسان رضوی"
        },
        new()
        {
            Id = "94",
            ProvinceName = "خراسان شمالی"
        },
        new()
        {
            Id = "97",
            ProvinceName = "خراسان جنوبی"
        },
        new()
        {
            Id = "98",
            ProvinceName = "سیستان و بلوچستان"
        },
        new()
        {
            Id = "99",
            ProvinceName = "سیستان و بلوچستان"
        }
    };

    /// <summary>
    ///     دريافت ناحيه كدپستي
    /// </summary>
    public static PostalCode? GetIranianPostalCode(this string? postalCode)
    {
        if (string.IsNullOrWhiteSpace(postalCode) || postalCode.Length <= 2)
        {
            return null;
        }

        var bin = postalCode.Substring(startIndex: 0, length: 2);

        return Items.FirstOrDefault(p => string.Equals(p.Id, bin, StringComparison.Ordinal));
    }
}